# üõ†Ô∏è Implementaci√≥n de Integraci√≥n Continua (CI) para Oracle APEX con Git y SQLcl

Este documento formaliza el proceso de **Integraci√≥n Continua (CI)** para la aplicaci√≥n **Oracle APEX (ID APP_ID)**. Se establece un flujo de trabajo que utiliza **Git** para el control de versiones y **SQLcl** como herramienta clave para la automatizaci√≥n de la exportaci√≥n, importaci√≥n y despliegue del c√≥digo fuente.

**Versi√≥n de SQLcl Utilizada:** **25.3.2.0 Production**

**Entorno:**

* **Workspace:** `WORKSPACE`
* **Esquema:** `SCHEMA`
* **Application ID:** `APP_ID`
* **SQLcl Shortcuts (Aliases):** `dev` (desarrollo), `prod` (producci√≥n)
* **Repositorio:** `https://github.com/project-repository`

## 1. üîó Herramientas y Recursos y Configuraci√≥n Inicial

### 1.1 Instalaci√≥n de Herramientas

Para implementar este proceso, necesitas instalar y configurar las siguientes herramientas en tu entorno local.

* **Git Cliente:** Descarga el cliente de Git para tu sistema operativo.
    * **URL:** [https://git-scm.com/downloads](https://git-scm.com/downloads)
* **Oracle SQLcl:** Descarga y configura el cliente SQLcl (versi√≥n 25.3.2.0 o superior recomendada).
    * **URL:** [https://www.oracle.com/database/technologies/appdev/sqlcl.html](https://www.oracle.com/database/technologies/appdev/sqlcl.html)
---

> De aqu√≠ en adelante el s√≠mbolo `$` significa la consola de la shell del sistema operativo o cmd shell en windows. El s√≠mbolo `sql>` significa la consola de comandos de SQLcl.

## 2. ‚öôÔ∏è Inicializaci√≥n y Configuraci√≥n del Proyecto

### 2.1 Creaci√≥n de Estructura Local y Repositorio

| Tarea | Explicaci√≥n | Comando Git |
| :--- | :--- | :--- |
| **2.1.1 Directorio** | Crea el directorio local que contendr√° todo el proyecto. Luego, navega a este directorio para ejecutar los comandos. | `$ mkdir apex-ci-project` <br> `$ cd apex-ci-project` |
| **2.1.2 Inicializar Git** | Inicializa un nuevo repositorio de Git en el directorio local, permitiendo el seguimiento de cambios. | `$ git init` |
| **2.1.3 Crear readme** | Crea un archivo `README.md` para documentar el proyecto. Se a√±ade de inmediato al *staging area* de Git. | `$ echo "# project-repository" >> README.md` <br> `git add README.md` |
| **2.1.4 Conectar a Remoto** | Vincula tu repositorio local con el repositorio remoto alojado en GitHub, d√°ndole el alias est√°ndar `origin`. | `$ git remote add origin https://github.com/project-repository` |
| **2.1.5 Crear Ramas** | Crea y cambia a la rama principal (`main`) y luego a la rama de desarrollo (`develop`). El trabajo se realiza primariamente en `develop`. | `$ git checkout -b main` <br> `$ git checkout -b develop` |
| **2.1.6 Estructura Base** | Crea el subdirectorio `apex/`, que ser√° el destino exclusivo de los *scripts* de exportaci√≥n de APEX, separ√°ndolos de otros archivos del proyecto (ej. *scripts* SQL de base de datos). | `$ mkdir apex` |
| **2.1.7 Configurar `.gitignore`** | Crea el archivo de exclusi√≥n para Git. Este archivo instruye a Git qu√© archivos ignorar (ej. archivos de *logs*, temporales o sensibles), manteni√©ndolos fuera del control de versiones. | `echo "*.log" >> .gitignore` <br> `echo "*.tmp" >> .gitignore` |

### 2.2 Configuraci√≥n de SQLcl con `project init`

Para facilitar la exportaci√≥n de APEX, **SQLcl 25.3.2.0** ofrece el comando `project init` para generar una estructura predefinida.

| Paso | Explicaci√≥n | Comandos SQLcl |
| :--- | :--- | :--- |
| **2.2.0 `project init`** | Ejecuta `project init` para crear la estructura de APEX y los archivos `.dbtools/project.config.json` y `.dbtools/filters/project.filters`| `$ sql user/'password'@host:port/SERVICE` <br> `sql> project init -name project-name -schemas db-schema` <br> `sql> exit` |

### 2.3 Exportaci√≥n Inicial de la Aplicaci√≥n (Baseline)

Se exporta la aplicaci√≥n APP_ID al directorio `apex/` para establecer la versi√≥n base en el repositorio.

| Paso | Explicaci√≥n | Comandos SQLcl y Git |
| :--- | :--- | :--- |
| **2.3.1 Conexi√≥n** | Inicia SQLcl y con√©ctate al entorno de desarrollo utilizando el *alias* configurado. | `$ sql user/'password'@host:port/SERVICE` |
| **2.3.2 Exportaci√≥n** | Exporta la aplicaci√≥n al subdirectorio `apex/`. Esto genera el *script* `fAPP_ID.sql`. | `sql> apex export -applicationid APP_ID -dir apex` <br> `sql> exit` |
| **2.3.3 Confirmaci√≥n** | A√±ade todos los archivos nuevos (exportaci√≥n, `.gitignore`, `sqlcl.json`, etc.) al √°rea de preparaci√≥n y crea el primer *commit* estableciendo la versi√≥n base (`Baseline`). | `$ git add --all` <br> `$ git commit -m "feat: Baseline inicial de Aplicacion APP_ID"` |
| **2.3.4 Carga Remota** | Sube la estructura base y el *script* de exportaci√≥n a GitHub en la rama `develop`. | `git push origin develop` |

---

## 3. üîÅ Ciclo de Desarrollo e Integraci√≥n Continua

### 3.1 Desarrollo y Exportaci√≥n de Cambios

El desarrollador trabaja en la rama `feature/tracking-number-feature-name` para aislar sus cambios y luego integra el c√≥digo a la rama `develop` solo cuando est√° listo.

| Paso | Explicaci√≥n | Comandos y Acciones |
| :--- | :--- | :--- |
| **3.1.1 Nueva Rama** | Crea y cambia a una rama de caracter√≠stica a partir de `develop`. | `$ git checkout -b feature/tracking-number-feature-name develop` |
| **3.1.2 Cambio en APEX** | Realiza el cambio necesario en el **Builder** de APEX. | *(Acci√≥n en el Builder de APEX)* |
| **3.1.3 Re-exportaci√≥n** | Con√©ctate a la BD de desarrollo y ejecuta el comando de exportaci√≥n. **SQLcl sobrescribe** el archivo `fAPP_ID.sql`. | `$ sql user/'password'@host:port/SERVICE` <br><br> `sql> apex export -applicationid APP_ID -dir apex` <br> `sql> exit` |
| **3.1.4 Confirmaci√≥n** | Confirma los archivos modificados. El mensaje de *commit* debe ser descriptivo. | `$ git add --all` <br> `$ git commit -m "fix: [bug tracking number] Descripcion del cambio"` |
| **3.1.5 Carga (Push)** | Sube la rama de caracter√≠stica al repositorio remoto. | `$ git push origin feature/bug-tracking-number-feature-name` |

### 3.2 Integraci√≥n y Pull de Cambios

Se simula la integraci√≥n de los cambios (t√≠picamente a trav√©s de un **Merge Request / Pull Request** en GitHub) y la sincronizaci√≥n del repositorio.

| Paso | Explicaci√≥n | Comandos Git |
| :--- | :--- | :--- |
| **3.2.1 Integraci√≥n** | Asume que el PR ha sido aprobado. Cambia a la rama `develop` e integra la rama de caracter√≠stica. | `git checkout develop` <br> `git merge feature/tracking-number-feature-name` |
| **3.2.2 Subir a Remoto** | Sincroniza la rama `develop` local con la remota. | `git push origin develop` |
| **3.2.3 Pull de Cambios** | Simulaci√≥n de un colega que actualiza su copia local. | `git pull origin develop` |

---

## 4. üè∑Ô∏è Gesti√≥n de Releases y Control de Versiones

Se utiliza Git para marcar puntos estables de la aplicaci√≥n que est√°n listos para pasar a producci√≥n.

| Tarea | Explicaci√≥n | Comandos Git |
| :--- | :--- | :--- |
| **4.1 Rama de *Release*** | Crea una rama de *release* estable a partir de `develop`. | `git checkout -b release/1.0.0` |
| **4.2 Etiquetar (*Tag*)** | Crea una **etiqueta (tag)** inmutable para marcar la versi√≥n can√≥nica y estable (**v1.0.0**). | `git tag -a v1.0.0 -m "Versi√≥n 1.0.0: Primera versi√≥n de producci√≥n estable."` |
| **4.3 Integraci√≥n a Main** | Mueve la rama `main` al punto de *release* estable. | `git checkout main` <br> `git merge release/1.0.0` |
| **4.4 Carga de Tags** | Sube el *tag* y la rama `main` al repositorio remoto. | `git push origin main` <br> `git push origin --tags` |

### 4.5 Gesti√≥n de *Releases* con SQLcl

Utiliza `project release` para generar *scripts* de instalaci√≥n y desinstalaci√≥n para el esquema de base de datos asociado al proyecto.

| Tarea | Explicaci√≥n | Comandos SQLcl |
| :--- | :--- | :--- |
| **4.5.1 Crear *Release*** | Ejecuta `project release` para generar *scripts* de instalaci√≥n y desinstalaci√≥n para el esquema. | `$ sql user/'password'@host:port/SERVICE` <br> `sql> project release 1.0.0` <br> `sql> exit` |
| **4.5.2 Revisar Archivos** | Verifica que se hayan creado los archivos `install.sql` y `uninstall.sql` en el directorio de *scripts* del proyecto. | *(Revisar la estructura de archivos)* |
| **4.5.3 Commit de Scripts** | Confirma estos nuevos *scripts* de *release* en Git para que formen parte del *tag* `v1.0.0`. | `$ git add install.sql uninstall.sql` <br> `$ git commit -m "release: v1.0.0 scripts de instalaci√≥n"` |

---

## 5. üö¢ Despliegue (Deploy) a Producci√≥n (CI/CD)

El despliegue a producci√≥n se realiza importando la aplicaci√≥n desde la versi√≥n estable (`main` o el *tag* `v1.0.0`). Este es el paso de **Entrega Continua (CD)**.

### 5.1 Preparaci√≥n del Despliegue

| Tarea | Explicaci√≥n | Comandos Git |
| :--- | :--- | :--- |
| **5.1.1 Obtener Versi√≥n** | Aseg√∫rate de que tu directorio de trabajo local est√© apuntando al *tag* exacto de la versi√≥n que vas a desplegar. | `$ git checkout v1.0.0` |

### 5.2 Ejecuci√≥n del Despliegue

| Paso | Explicaci√≥n | Comando SQLcl |
| :--- | :--- | :--- |
| **5.2.1 Conexi√≥n PROD** | Con√©ctate a la base de datos de producci√≥n. | `$ sql user/'password'@host:port/SERVICE` |
| **5.2.2 Importaci√≥n** | Ejecuta el *script* de exportaci√≥n (`fAPP_ID.sql`) que est√° en la versi√≥n etiquetada. | `@apex/fAPP_ID.sql` |
| **5.2.3 Finalizaci√≥n** | Cierra la conexi√≥n. | `sql> exit` |

**Conclusi√≥n:** Este flujo utiliza **Git** para gestionar el **qu√©** se despliega (la versi√≥n etiquetada) y **SQLcl** para gestionar el **c√≥mo** (la ejecuci√≥n automatizada del *script* de exportaci√≥n e importaci√≥n).